<div class="flex flex-col h-screen bg-whatsapp-dark text-gray-100">
  <!-- Header -->
  <div class="bg-whatsapp-gray border-b border-gray-700 px-6 py-4 shrink-0">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-semibold text-gray-100">
          {{ isEditMode ? ('customers.editCustomer' | translate) : ('customers.newCustomer' | translate) }}
        </h1>
        <p class="text-sm text-gray-400 mt-1">
          {{ isEditMode ? ('customers.updateCustomerInfo' | translate) : ('customers.addCustomerSubtitle' | translate) }}
        </p>
      </div>
      <button (click)="cancel()"
              class="text-gray-400 hover:text-gray-200 flex items-center gap-2">
        <i class="fas fa-times"></i>
        <span>{{ 'common.cancel' | translate }}</span>
      </button>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="mx-6 mt-4 bg-red-900/20 border border-red-600 text-red-400 px-4 py-3 rounded-lg">
    <i class="fas fa-exclamation-circle mr-2"></i>
    {{ error }}
  </div>

  <!-- Form -->
  <div class="flex-1 overflow-auto px-6 py-4">
    <form (ngSubmit)="saveCustomer()" class="max-w-4xl mx-auto space-y-6">
      <!-- Basic Information -->
      <div class="bg-whatsapp-gray rounded-lg p-6 border border-gray-700">
        <h3 class="text-lg font-semibold text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-user text-whatsapp-green"></i> {{ 'customers.basicInformation' | translate }}
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-400 mb-2">
              {{ 'customers.phoneNumber' | translate }} <span class="text-red-400">{{ 'customers.required' | translate }}</span>
            </label>
            <input type="text"
                   [(ngModel)]="customer.phoneNumber"
                   name="phoneNumber"
                   [placeholder]="'customers.phonePlaceholder' | translate"
                   required
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.email' | translate }}</label>
            <input type="email"
                   [(ngModel)]="customer.email"
                   name="email"
                   [placeholder]="'customers.emailPlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.firstName' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.firstName"
                   name="firstName"
                   [placeholder]="'customers.firstNamePlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.lastName' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.lastName"
                   name="lastName"
                   [placeholder]="'customers.lastNamePlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>
        </div>
      </div>

      <!-- Classification -->
      <div class="bg-whatsapp-gray rounded-lg p-6 border border-gray-700">
        <h3 class="text-lg font-semibold text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-tags text-whatsapp-green"></i> {{ 'customers.classification' | translate }}
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.segment' | translate }}</label>
            <select [(ngModel)]="customer.segment"
                    name="segment"
                    class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
              <option *ngFor="let segment of segments" [value]="segment">{{ segment | titlecase }}</option>
            </select>
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.status' | translate }}</label>
            <select [(ngModel)]="customer.status"
                    name="status"
                    class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
              <option *ngFor="let status of statuses" [value]="status">{{ status | titlecase }}</option>
            </select>
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.source' | translate }}</label>
            <select [(ngModel)]="customer.source"
                    name="source"
                    class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
              <option *ngFor="let source of sources" [value]="source">{{ formatSource(source) }}</option>
            </select>
          </div>
        </div>

        <!-- Tags -->
        <div class="mt-4">
          <label class="block text-sm text-gray-400 mb-2">{{ 'customers.tags' | translate }}</label>
          <div class="flex gap-2 mb-2">
            <input type="text"
                   [(ngModel)]="tagInput"
                   name="tagInput"
                   (keyup.enter)="addTag()"
                   [placeholder]="'customers.addTagPlaceholder' | translate"
                   class="flex-1 bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
            <button type="button"
                    (click)="addTag()"
                    class="bg-whatsapp-green hover:bg-green-600 text-white px-4 py-2 rounded-lg">
              <i class="fas fa-plus"></i>
            </button>
          </div>
          <div class="flex flex-wrap gap-2">
            <span *ngFor="let tag of customer.tags"
                  class="px-3 py-1 bg-blue-900/30 text-blue-400 rounded-full text-sm flex items-center gap-2">
              {{ tag }}
              <button type="button" (click)="removeTag(tag)" class="hover:text-red-400">
                <i class="fas fa-times text-xs"></i>
              </button>
            </span>
          </div>
        </div>
      </div>

      <!-- Address -->
      <div class="bg-whatsapp-gray rounded-lg p-6 border border-gray-700">
        <h3 class="text-lg font-semibold text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-map-marker-alt text-whatsapp-green"></i> {{ 'customers.address' | translate }}
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="md:col-span-2">
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.street' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.address!.street"
                   name="street"
                   [placeholder]="'customers.streetPlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.city' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.address!.city"
                   name="city"
                   [placeholder]="'customers.cityPlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.state' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.address!.state"
                   name="state"
                   [placeholder]="'customers.statePlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.country' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.address!.country"
                   name="country"
                   [placeholder]="'customers.countryPlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.postalCode' | translate }}</label>
            <input type="text"
                   [(ngModel)]="customer.address!.postalCode"
                   name="postalCode"
                   [placeholder]="'customers.postalCodePlaceholder' | translate"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>
        </div>
      </div>

      <!-- Notes -->
      <div class="bg-whatsapp-gray rounded-lg p-6 border border-gray-700">
        <h3 class="text-lg font-semibold text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-sticky-note text-whatsapp-green"></i> {{ 'customers.notes' | translate }}
        </h3>

        <textarea [(ngModel)]="customer.notes"
                  name="notes"
                  rows="4"
                  [placeholder]="'customers.addNotesPlaceholder' | translate"
                  class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none resize-none"></textarea>
      </div>

      <!-- Preferences -->
      <div class="bg-whatsapp-gray rounded-lg p-6 border border-gray-700">
        <h3 class="text-lg font-semibold text-gray-100 mb-4 flex items-center gap-2">
          <i class="fas fa-cog text-whatsapp-green"></i> {{ 'customers.preferences' | translate }}
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.language' | translate }}</label>
            <select [(ngModel)]="customer.preferences!.language"
                    name="language"
                    class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
              <option value="es">{{ 'customers.spanish' | translate }}</option>
              <option value="en">{{ 'customers.english' | translate }}</option>
            </select>
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.communicationStart' | translate }}</label>
            <input type="time"
                   [(ngModel)]="customer.preferences!.communicationHours!.start"
                   name="commStart"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>

          <div>
            <label class="block text-sm text-gray-400 mb-2">{{ 'customers.communicationEnd' | translate }}</label>
            <input type="time"
                   [(ngModel)]="customer.preferences!.communicationHours!.end"
                   name="commEnd"
                   class="w-full bg-whatsapp-dark text-gray-100 px-4 py-2 rounded-lg border border-gray-600 focus:border-whatsapp-green focus:outline-none">
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex gap-3 justify-end pb-6">
        <button type="button"
                (click)="cancel()"
                class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors">
          {{ 'common.cancel' | translate }}
        </button>
        <button type="submit"
                [disabled]="loading"
                class="px-6 py-3 bg-whatsapp-green hover:bg-green-600 text-white rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
          <i *ngIf="loading" class="fas fa-spinner fa-spin"></i>
          <i *ngIf="!loading" class="fas fa-save"></i>
          <span>{{ isEditMode ? ('customers.updateCustomer' | translate) : ('customers.createCustomer' | translate) }}</span>
        </button>
      </div>
    </form>
  </div>
</div>
