<div class="date-picker-wrapper" #calendar>
    <!-- Input Field -->
    <div class="relative">
        <label *ngIf="label" class="block text-sm font-medium text-gray-300 mb-2">
            {{ label }}
        </label>
        <div class="relative">
            <input
                type="text"
                [value]="selectedDate ? formatDateForDisplay(selectedDate) : ''"
                [placeholder]="placeholder"
                (click)="toggleCalendar()"
                readonly
                class="w-full px-3 py-2 pr-20 bg-gray-700 text-white rounded-lg border border-gray-600
                       focus:border-blue-500 focus:outline-none cursor-pointer transition-colors
                       hover:bg-gray-650"
            />
            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1">
                <button
                    *ngIf="selectedDate"
                    type="button"
                    (click)="clearDate(); $event.stopPropagation()"
                    class="p-1 text-gray-400 hover:text-white transition-colors"
                    title="Clear date"
                >
                    <i class="fas fa-times text-sm"></i>
                </button>
                <button
                    type="button"
                    (click)="toggleCalendar(); $event.stopPropagation()"
                    class="p-1 text-gray-400 hover:text-blue-400 transition-colors"
                >
                    <i class="fas fa-calendar text-sm"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Calendar Dropdown -->
    <div
        *ngIf="showCalendar"
        class="absolute z-50 mt-2 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl
               animate-fadeIn overflow-hidden"
        style="min-width: 280px;"
    >
        <!-- Calendar Header -->
        <div class="bg-gray-700 px-4 py-3 flex items-center justify-between border-b border-gray-600">
            <button
                type="button"
                (click)="previousMonth()"
                class="p-1 text-gray-400 hover:text-white hover:bg-gray-600 rounded transition-colors"
            >
                <i class="fas fa-chevron-left"></i>
            </button>

            <div class="font-semibold text-white">
                {{ monthNames[currentMonth.getMonth()] }} {{ currentMonth.getFullYear() }}
            </div>

            <button
                type="button"
                (click)="nextMonth()"
                class="p-1 text-gray-400 hover:text-white hover:bg-gray-600 rounded transition-colors"
            >
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <!-- Day Names -->
        <div class="grid grid-cols-7 bg-gray-750 px-2 py-2">
            <div
                *ngFor="let day of dayNames"
                class="text-center text-xs font-medium text-gray-400 py-1"
            >
                {{ day }}
            </div>
        </div>

        <!-- Calendar Days -->
        <div class="px-2 py-2">
            <div *ngFor="let week of weeks" class="grid grid-cols-7 gap-1">
                <button
                    *ngFor="let date of week"
                    type="button"
                    (click)="selectDate(date)"
                    [disabled]="isDisabled(date)"
                    [class]="
                        !date
                            ? 'invisible'
                            : 'w-8 h-8 rounded-lg text-sm font-medium transition-all ' +
                              (isSelected(date)
                                ? 'bg-blue-600 text-white hover:bg-blue-700 shadow-lg'
                                : isToday(date)
                                ? 'bg-blue-900 bg-opacity-30 text-blue-400 border border-blue-600 hover:bg-blue-800 hover:bg-opacity-40'
                                : isDisabled(date)
                                ? 'text-gray-600 cursor-not-allowed opacity-50'
                                : 'text-gray-300 hover:bg-gray-700 hover:text-white')
                    "
                >
                    {{ date?.getDate() }}
                </button>
            </div>
        </div>

        <!-- Calendar Footer -->
        <div class="bg-gray-700 px-4 py-2 flex items-center justify-between border-t border-gray-600">
            <button
                type="button"
                (click)="goToToday()"
                class="text-xs text-blue-400 hover:text-blue-300 font-medium transition-colors"
            >
                <i class="fas fa-calendar-day mr-1"></i>
                Today
            </button>
            <button
                type="button"
                (click)="clearDate()"
                class="text-xs text-gray-400 hover:text-white font-medium transition-colors"
            >
                <i class="fas fa-times-circle mr-1"></i>
                Clear
            </button>
        </div>
    </div>
</div>
