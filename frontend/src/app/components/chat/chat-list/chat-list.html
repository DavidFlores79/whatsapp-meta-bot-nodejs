<div class="flex flex-col h-full bg-whatsapp-dark border-r border-gray-700">
    <!-- Search -->
    <div class="p-2 bg-whatsapp-dark border-b border-gray-700 shrink-0">
        <div class="bg-whatsapp-gray rounded-lg flex items-center px-4 py-1.5">
            <i class="fas fa-search text-gray-400 text-sm"></i>
            <input type="text" [placeholder]="'chat.searchPlaceholder' | translate"
                class="bg-transparent border-none text-gray-200 text-sm ml-4 w-full focus:outline-none placeholder-gray-400">
        </div>
    </div>

    <!-- Tabs -->
    <div class="flex bg-whatsapp-dark border-b border-gray-700 shrink-0">
        <button
            (click)="setActiveTab('queue')"
            [class.border-whatsapp-green]="activeTab === 'queue'"
            [class.text-whatsapp-green]="activeTab === 'queue'"
            class="flex-1 py-3 text-sm font-medium text-gray-400 hover:text-gray-200 border-b-2 border-transparent transition-colors relative">
            {{ 'chat.queue' | translate }}
            <span *ngIf="(queueChats$ | async)?.length as count"
                  class="ml-2 bg-whatsapp-green text-whatsapp-dark text-xs font-bold rounded-full px-2 py-0.5">
                {{ count }}
            </span>
        </button>
        <button
            (click)="setActiveTab('mine')"
            [class.border-whatsapp-green]="activeTab === 'mine'"
            [class.text-whatsapp-green]="activeTab === 'mine'"
            class="flex-1 py-3 text-sm font-medium text-gray-400 hover:text-gray-200 border-b-2 border-transparent transition-colors relative">
            {{ 'chat.myChats' | translate }}
            <span *ngIf="(myChats$ | async)?.length as count"
                  class="ml-2 bg-blue-500 text-white text-xs font-bold rounded-full px-2 py-0.5">
                {{ count }}
            </span>
        </button>
        <button
            (click)="setActiveTab('all')"
            [class.border-whatsapp-green]="activeTab === 'all'"
            [class.text-whatsapp-green]="activeTab === 'all'"
            class="flex-1 py-3 text-sm font-medium text-gray-400 hover:text-gray-200 border-b-2 border-transparent transition-colors">
            {{ 'chat.all' | translate }}
        </button>
    </div>

    <!-- Chat List -->
    <div class="flex-1 overflow-y-auto custom-scrollbar">
        <div *ngFor="let chat of getDisplayChats() | async" (click)="selectChat(chat.id)"
            [class.bg-whatsapp-gray]="(selectedChatId$ | async) === chat.id"
            class="flex items-center p-3 cursor-pointer hover:bg-whatsapp-gray transition-colors border-b border-gray-800">

            <!-- Avatar -->
            <div class="w-12 h-12 rounded-full overflow-hidden shrink-0 mr-3 relative">
                <img [src]="chat.avatar" [alt]="chat.name" class="w-full h-full object-cover">
                <!-- Assignment indicator -->
                <div *ngIf="chat.assignedAgent"
                     class="absolute bottom-0 right-0 w-3 h-3 bg-blue-500 rounded-full border-2 border-whatsapp-dark"
                     title="Assigned">
                </div>
            </div>

            <!-- Content -->
            <div class="flex-1 min-w-0">
                <div class="flex justify-between items-baseline mb-1">
                    <h3 class="text-gray-100 font-medium truncate">{{ chat.name }}</h3>
                    <span class="text-xs text-gray-400 shrink-0">{{ chat.lastMessageTime | date:'shortTime' }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-400 truncate pr-2">{{ chat.lastMessage }}</p>
                    <div *ngIf="chat.unreadCount > 0"
                        class="bg-whatsapp-green text-whatsapp-dark text-xs font-bold rounded-full h-5 min-w-[1.25rem] flex items-center justify-center px-1">
                        {{ chat.unreadCount }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty state -->
        <div *ngIf="(getDisplayChats() | async)?.length === 0"
             class="flex flex-col items-center justify-center h-full text-gray-500 p-8 text-center">
            <i class="fas fa-inbox text-4xl mb-4 opacity-50"></i>
            <p class="text-sm">
                <ng-container *ngIf="activeTab === 'queue'">{{ 'chat.noConversationsInQueue' | translate }}</ng-container>
                <ng-container *ngIf="activeTab === 'mine'">{{ 'chat.noConversationsAssigned' | translate }}</ng-container>
                <ng-container *ngIf="activeTab === 'all'">{{ 'chat.noConversationsYet' | translate }}</ng-container>
            </p>
        </div>
    </div>
</div>
